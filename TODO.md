# Hydra Evolution: Strategic Roadmap & Implementation Plan

## Big Picture Vision

The competitive analysis reveals a clear strategic path: Hydra must evolve from a powerful AI development *assistant* into an autonomous AI development *foundry*. Our core strength is the **Living Blueprint (`genesis.xml`)**, a stateful, executable artifact that is architecturally superior to the static plans generated by competitors like Context Forge. Our next evolution will lean heavily into this unique advantage, transforming every completed project into a rich dataset for organizational learning and process improvement. We will match our competitor's high-value features—like legacy code enhancement and migration planning—but implement them on our more robust, stateful foundation. The ultimate goal is to create a system that doesn't just help developers build software, but becomes a self-improving, autonomous entity capable of managing the entire software lifecycle.

## Guiding Principles for Implementation

To achieve a top-tier result, we must adhere to several key principles throughout this evolution. First, **every new feature must deepen, not dilute, the Living Blueprint's role.** The `genesis.xml` is our moat; every command should either enrich it or leverage its data in a novel way. Second, **maintain a ruthless focus on the user's highest-value problems**, which are brownfield development (enhancing existing code) and managing technical debt, not just greenfield projects. Third, **prioritize trust and reliability.** As we introduce more autonomy (`hydra orchestrate`), our diagnostic and self-healing capabilities (`hydra doctor`) must become proportionally more powerful. We must avoid "black box" autonomy by ensuring every automated action is logged and auditable within the Living Blueprint. Finally, we will **"pave the cowpaths"** of AI development, formalizing emergent best practices (like the "PRP" concept) into our structured, opinionated workflow to provide a clear, reliable path for users.

## Hyper-Detailed Implementation Workflow

```xml
<master_workflow name="HYDRA_EVOLUTION_PLAN_V2" version="2.0">
  <objective>Evolve Hydra into an autonomous development foundry by implementing strategic enhancements based on competitive analysis.</objective>

  <!-- ====================================================================== -->
  <!-- CATEGORY 1: QUICK WINS (Low Effort, High Impact)                      -->
  <!-- ====================================================================== -->
  <phase name="Quick Wins">

    <task id="supercharge-doctor">
      <name>Supercharge `hydra doctor` Command</name>
      <description>Transform `hydra doctor` into a comprehensive diagnostic and self-healing tool.</description>
      <agent>typescript-node-developer</agent>
      <steps>
        <step number="1" action="Modify `bin/hydra.mjs`">
          <detail>Locate the `HealthChecker` class and the `runAllChecks` method. Prepare to add new check functions.</detail>
        </step>
        <step number="2" action="Implement `genesis.xml` Schema Validation">
          <detail>Create a new method `checkLivingBlueprints`. This method will use `glob` or `fs.readdir` to find all `genesis.xml` files within the `.claude/epics/` directory.</detail>
          <detail>For each `genesis.xml` found, execute the command `xmlstarlet val -s rules/genesis.xsd path/to/genesis.xml` using `child_process.execSync`.</detail>
          <detail>Capture the output. If the command fails (non-zero exit code), report the file path and the stderr from `xmlstarlet` as a validation failure.</detail>
        </step>
        <step number="3" action="Implement Agent File Validation">
          <detail>Create a new method `checkAgentIntegrity`. This method will scan all `.md` files in the `agents/` subdirectories.</detail>
          <detail>For each agent file, read its content, parse the YAML frontmatter, and validate that the required fields (`name`, `description`) exist.</detail>
          <detail>Verify that any `@` references to base configurations (e.g., `@engineering-base-config.yml`) point to an existing file.</detail>
        </step>
        <step number="4" action="Implement `--auto-fix` Flag">
          <detail>Add a new option `--auto-fix` to the `doctor` command definition in `bin/hydra.mjs`.</detail>
          <detail>In the `executeDoctor` function, check if this flag is present.</detail>
          <detail>If `--auto-fix` is enabled, modify the `checkAgentIntegrity` function to write back fixes to the agent files (e.g., adding a placeholder `description: 'TODO'` if missing).</detail>
          <detail>Report all fixes applied to the console.</detail>
        </step>
        <step number="5" action="Update CLI Output">
          <detail>Refine the `reportResults` method in `HealthChecker` to clearly display the results from the new checks, including any auto-fixes performed.</detail>
        </step>
      </steps>
      <validation>Run `hydra doctor` and `hydra doctor --auto-fix` in a test project with deliberately corrupted agent files and `genesis.xml` files to ensure proper detection and correction.</validation>
    </task>

    <task id="adopt-prp-terminology">
      <name>Adopt "PRP" Terminology and Formalize Artifacts</name>
      <description>Perform a global find-and-replace to align with industry terminology and formalize the planning artifact.</description>
      <agent>refactoring-specialist</agent>
      <steps>
        <step number="1" action="Perform Global Find & Replace">
          <detail>Search for all instances of "Strategic Brief" (case-insensitive) across all project files (`.md`, `.mjs`).</detail>
          <detail>Replace them with "Product Requirement Prompt (PRP)".</detail>
        </step>
        <step number="2" action="Update `hydra new` Command Logic">
          <detail>In `bin/hydra.mjs` (`executeNew` function), change the output filename from `strategic-brief.md` to `prp.md`.</detail>
          <detail>Update all related console log messages to reference "PRP".</detail>
        </step>
        <step number="3" action="Update `plan-generator` Agent Prompt">
          <detail>Edit `agents/project-management/plan-generator.md` to state that its primary input is the `prp.md` file.</detail>
        </step>
      </steps>
      <validation>Run `hydra new test-feature` and verify that a `prp.md` file is created and the CLI output uses the new terminology.</validation>
    </task>

  </phase>

  <!-- ====================================================================== -->
  <!-- CATEGORY 2: STRATEGIC EVOLUTIONS (Medium Effort)                      -->
  <!-- ====================================================================== -->
  <phase name="Strategic Evolutions">

    <task id="create-enhance-command">
      <name>Create `hydra enhance` Command</name>
      <description>Build the functionality to apply Hydra's planning and execution to existing codebases.</description>
      <agent>backend-architect</agent>
      <steps>
        <step number="1" action="Create New `code-analyzer` Agent">
          <detail>Create a new agent file at `agents/utilities/code-analyzer.md`.</detail>
          <detail>Define its system prompt to perform static analysis. It should identify language, framework, dependencies (`package.json`, etc.), and architectural patterns. It must output a structured "Codebase Analysis Report" in markdown format.</detail>
          <detail>Grant it access to `serena`, `git`, and filesystem tools in its YAML frontmatter.</detail>
        </step>
        <step number="2" action="Add `hydra enhance` Command to CLI">
          <detail>In `bin/hydra.mjs`, add a new command `enhance <feature-description>`.</detail>
          <detail>Create the `executeEnhance` function. This function will first invoke the new `code-analyzer` agent on the current directory.</detail>
        </step>
        <step number="3" action="Integrate `code-analyzer` with `plan-generator`">
          <detail>The `executeEnhance` function will take the "Codebase Analysis Report" from `code-analyzer`, combine it with the user's `<feature-description>`, and format it into a *synthetic PRP*.</detail>
          <detail>This synthetic PRP will then be passed as input to the `plan-generator` agent, which will proceed to create the `genesis.xml` for the enhancement task.</detail>
        </step>
      </steps>
      <validation>Run `hydra enhance "add a dark mode toggle"` on a simple test project and verify that the resulting `genesis.xml` contains tasks related to modifying existing CSS and JS files.</validation>
    </task>

    <task id="evolve-recap-command">
      <name>Evolve `hydra recap` into an "Intelligence Report"</name>
      <description>Enhance the recap functionality to perform deep analysis of the completed `genesis.xml` for process improvement insights.</description>
      <agent>project-shipper</agent>
      <steps>
        <step number="1" action="Enhance `project-shipper` Agent Prompt">
          <detail>Edit `agents/project-management/project-shipper.md`. Update its prompt to perform a detailed analysis of the provided `genesis.xml`.</detail>
          <detail>The new prompt must instruct the agent to use `xmlstarlet` to perform specific analytical queries.</detail>
        </step>
        <step number="2" action="Implement Analytical `xmlstarlet` Queries">
          <detail>Add logic to compare `estimatedDuration` with actual duration calculated from `<statusHistory>` timestamps for each task.</detail>
          <detail>Add logic to extract and categorize all entries from `<knowledgeBase>`.</detail>
          <detail>Add logic to parse the `<auditLog>` into a chronological event timeline.</detail>
          <detail>Add logic to tally task assignments by agent from the `<assignedAgent>` field.</detail>
        </step>
        <step number="3" action="Create New "Intelligence Report" Template">
          <detail>Define a new markdown template for the output. It must include sections for "Performance Metrics (Estimation vs. Actual)", "Key Architectural Decisions", "Unexpected Learnings", and "Agent Effectiveness Report".</detail>
          <detail>The `project-shipper` will populate this template with the data analyzed in the previous step.</detail>
        </step>
      </steps>
      <validation>Create a sample completed `genesis.xml` with varied task durations and knowledge entries. Run `hydra recap` and verify the output report contains the correct analysis.</validation>
    </task>

  </phase>

  <!-- ====================================================================== -->
  <!-- CATEGORY 3: GAME-CHANGING BETS (High Effort)                          -->
  <!-- ====================================================================== -->
  <phase name="Game-Changing Bets">

    <task id="build-orchestrate-command">
      <name>Build `hydra orchestrate` Command for True Autonomy</name>
      <description>Create a long-running daemon process that autonomously manages and executes projects based on a Living Blueprint.</description>
      <agent>super-hard-problem-developer</agent>
      <steps>
        <step number="1" action="Design Daemon Architecture">
          <detail>Plan a persistent background process using a robust Node.js library like `pm2` or a simple `nohup` script. The process will be the main scheduler.</detail>
        </step>
        <step number="2" action="Implement State Machine Scheduler">
          <detail>The core of the daemon will be a state machine that reads an epic's `genesis.xml` file on a set interval (e.g., cron-like, every 5 minutes).</detail>
          <detail>The scheduler's logic will identify the next available set of parallel tasks from the `<executionDag>` that are in the `<pending>` state and whose dependencies are met.</detail>
        </step>
        <step number="3" action="Implement Autonomous `hydra run` Invocation">
          <detail>The scheduler will programmatically construct and spawn a `hydra run` command as a child process for the identified tasks.</detail>
          <detail>It must capture the `pid` and logs of the child process for monitoring.</detail>
        </step>
        <step number="4" action="Implement Monitoring and Error Handling">
          <detail>The daemon will monitor its child processes. On successful completion, it logs it to the `genesis.xml` audit trail.</detail>
          <detail>On failure, it marks the task as `<failed>` in the XML, captures the error log, and can be programmed with simple retry logic or to pause and alert a human.</detail>
        </step>
      </steps>
      <validation>Launch `hydra orchestrate my-epic`. Observe the daemon correctly picking up and executing the first level of tasks from `genesis.xml`. Manually update a task to `<completed>` in the XML and observe the daemon picking up the next level of dependent tasks on its next cycle.</validation>
    </task>

  </phase>
</master_workflow>
```